var s61ntrx={};document.addEventListener("DOMContentLoaded",(function(){const e=Y(".s61_calendar"),t={d1:{name:"شنبه",dayOfWeek:6,baseDate:""},d2:{name:"یکشنبه",dayOfWeek:0,baseDate:""},d3:{name:"دوشنبه",dayOfWeek:1,baseDate:""},d4:{name:"سه شنبه",dayOfWeek:2,baseDate:""},d5:{name:"چهارشنبه",dayOfWeek:3,baseDate:""},d6:{name:"پنجشنبه",dayOfWeek:4,baseDate:""},d7:{name:"جمعه",dayOfWeek:5,baseDate:""}},i=1,n=2,s=3,r=4;let o=(e,t=!1,i=0,n=5,s=15)=>{setTimeout((()=>{let r=e.clientWidth-i,o=0,d=document.createElement("p");d.style.position="fixed",d.style.fontFamily=l(e,"font-family"),d.style.fontWeight=l(e,"font-weight");let u=l(e,"white-space");if(t){e.style.whiteSpace="nowrap",e.appendChild(d);let t=0;for(const i of e.childNodes)if(i.id){let e=i.currentStyle||window.getComputedStyle(i),n=parseFloat(e.marginLeft)+parseFloat(e.marginRight),s=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight),r=parseFloat(e.borderLeftWidth)+parseFloat(e.borderRightWidth);o+=parseInt(i.offsetWidth),t+=n+s+r}let i=parseInt(getComputedStyle(e).fontSize);d.remove(),a(e,i,r,o,t,n,s),e.style.whiteSpace=u}else{d.textContent=e.textContent,d.style.whiteSpace="nowrap",e.appendChild(d);let t=e.currentStyle||window.getComputedStyle(e),i=(parseFloat(t.marginLeft),parseFloat(t.marginRight),parseFloat(t.paddingLeft),parseFloat(t.paddingRight),parseFloat(t.borderLeftWidth),parseFloat(t.borderRightWidth),parseInt(getComputedStyle(e).fontSize));o=d.offsetWidth,d.remove(),a(e,i,r,o,0,n,s),e.style.whiteSpace=u}}),200)},a=(e,t,i,n,s=0,r,o)=>{let a=Math.floor(t*((i-s)/n)*10)/10;e.style=a>o?`font-size : ${o}px;`:a<r?`font-size : ${r}px;`:`font-size : ${a}px;`},l=(e,t)=>window.getComputedStyle(e,null).getPropertyValue(t);var d,u,p=Math.floor((1*new Date-1*new Date(2023,8,23))/864e5),c=Y("#s61w"),f=Y("#s61_parent"),m=Y(c.dataset.i),g=Y(c.dataset.t),v=Y("h1"),h=Y("#s61i"),_=c.dataset.baseurl,y=c.dataset.ga,b=c.dataset.domain,E=Y("#s61profile"),w=(g=null!==g?g.textContent.trim():null,p>1&&null!==m&&null!==g&&void 0!==b),T=localStorage,D="S61P",L="S61F",k=window.self.location.origin,S=decodeURIComponent(location.pathname),O="https://notrex.ir/",x=ie(S),I=O+"liveouter/v2/programlist?hash="+ie(b),C=O+"liveouter/v2/livestatus?hash="+ie(b)+"&adssiteandsupporterid=",W=Y("#s61m"),$=Y("#s61a"),j=Y("#s61n"),F=(Y("#s61s"),1),M=[],N={},H=Y(".s61_info_state"),R="s61o",q=Y("#s61timestartlive"),J=Y("#s61supportername"),A=[],P={};function Y(e){return document.querySelector(e)}function z(){f.style.display="none"}function U(e,t){K(e,R,t)}function K(e,t,i){e&&e.classList&&(e=e.classList,i?e.remove(t):e.add(t))}function B(e){let t=e?new Date(e):new Date;return t=t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear(),t=new Date(t).getTime(),t}function V(){var e=document.createElement("link");e.type="text/css",e.rel="stylesheet",e.href="/notrex/v1/lib_assistant/lib_assistant.css",document.head.appendChild(e),ee(9)}function X(e){if(function(e){let t=1*new Date;if(e){let i=P.d1.events;if(i.forEach((e=>{e.isonline=0})),e.selflive&&e.selflive.length>0)for(let n=0;n<e.selflive.length;n++){i.find((i=>{if(i.startEventTime<=t&&t<=i.endEventTime&&i.supporterid==e.selflive[n].supporterid)return!0}))?i.forEach((i=>{i.startEventTime<=t&&t<=i.endEventTime&&i.supporterid==e.selflive[n].supporterid&&(i.isonline=e.selflive[n].isonline,i.liveTitle=e.selflive[n].title,i.viewerqty=e.selflive[n].viewerqty)})):i.forEach((t=>{if((-1==t.startEventTime||0==t.startEventTime)&&t.supporterid==e.selflive[n].supporterid){let i=e.selflive[n].isonline;t.startEventTime=i?0:-1,t.isonline=i,t.liveTitle=e.selflive[n].title,t.viewerqty=e.selflive[n].viewerqty}}))}if(e.adslive&&e.adslive.length>0)for(let n=0;n<e.adslive.length;n++)i.forEach((i=>{i.startEventTime<=t&&t<=i.endEventTime&&i.siteid==e.adslive[n].siteid&&i.supporterid==e.adslive[n].supporterid&&(i.isonline=e.adslive[n].isonline,i.viewerqty=e.adslive[n].viewerqty)}))}let i=P.d1;i.events=me(i.startDate,i.endDate,!0);let n=0;for(let e=0;e<i.events.length;e++)i.events[e].endEventTime>t&&n++;Y("#s61_paginated_list button:nth-child(1) .s61_show_number_of_day").textContent=n,he(u)}(e),M=[],e.selflive&&e.selflive.length>0&&e.selflive.forEach((e=>{N.list.find((t=>{e.isonline&&t.supporterid==e.supporterid&&(e.supportername=t.supportername,e.supporterstrid=t.supporterstrid,e.siteid=N.siteid,e.sitestrid=N.sitestrid,G(M,[["sitestrid",e.sitestrid],["supporterid",e.supporterid]])&&M.push(e))}))})),e.adslive&&e.adslive.length>0&&e.adslive.forEach((e=>{N.adslist.program.find((t=>{e.isonline&&t.supporterid==e.supporterid&&t.siteid==e.siteid&&(e.supportername=t.supportername,e.supporterstrid=t.supporterusername,e.siteid=t.siteid,e.sitestrid=t.sitestrid,e.title=t.title,G(M,[["sitestrid",e.sitestrid],["supporterid",e.supporterid]])&&M.push(e))}))})),(!e.adslive||e.adslive.length<1)&&(!e.selflive||e.selflive.length<1)){let e=0,t=Object.keys(P);for(let i=0;i<t.length;i++){let n=P[t[i]];if(n.events&&n.events.length>0&&(n.events.forEach((t=>{t.startEventTime>99&&(G(M,[["sitestrid",t.sitestrid],["supporterid",t.supporterid]])&&M.push(t),e++)})),e>0))break}if(e<1){let e=P.d1;e&&(e=e.events,e&&e.forEach((e=>{G(M,[["sitestrid",e.sitestrid],["supporterid",e.supporterid]])&&M.push(e)})))}}if(M.length<1)U($),j.textContent=e.msg?e.msg:-2===e.status?"لایو ناترکس غیر فعال است":"برنامه ای قرار نگرفته است",q.textContent="",o(j);else{var t=0;W.onmouseenter=W.onmouseleave=function(e){F="mouseleave"===e.type?1:0},Z(M[t]),M.length>1&&(clearInterval(d),d=setInterval((function(){F&&(t>=M.length-1&&(t=-1),Z(M[++t]))}),1e4))}}function G(e,t){let i=0;return 0==e.length||(t.forEach((t=>{2==t.length&&e.forEach((e=>{e[t[0]]==t[1]&&i++}))})),!(i==t.length))}function Z(e){Q(),setTimeout((function(){E.href=O+"s/"+e.sitestrid+"?snum="+e.supporterid,Q(),q.classList.remove("s61livemode"),e.isonline?(K(h,"s61anim"),q.textContent=e.viewerqty+" بیننده",q.classList.add("s61livemode"),K(c,"s61_blink")):(K(c,"s61_blink",1),q.textContent=e.startEventTime>999?function(e){let i=new Date(e),n=ye(t,"dayOfWeek",i.getDay()).name,s=1==String(i.getMinutes()).length?"0"+i.getMinutes():i.getMinutes(),r=i.getHours()+":"+s;return n+" "+r}(e.startEventTime):"",K(h,"s61anim",1)),j.textContent=e.title,$.src=e.supporterImage?e.supporterImage:O+"user/"+e.supporterstrid+"/user_avatar.jpg",J.textContent=e.supportername,o(j),o(H,!0,40)}),800)}function Q(){W.classList.toggle("s61h")}function ee(e){setTimeout((function(){var e,t,i=JSON.parse(T.getItem("s61live")),n=1*new Date;i&&(e=i.last_check,t=i.next_check),i&&e+t>n?(ee(i.next_check),X(i)):fetch(C+function(){let e="",t=1*new Date,i=A.filter((e=>{if(e.startEventTime<=t&&t<=e.endEventTime)return e}));for(const t of i)t.eventType==s&&(e+=`${t.siteid}:${t.supporterid},`);return e.length>1?e:"no"}()).then((function(e){return e.json()})).then((function(e){e.last_check=n,ee(e.next_check),T.setItem("s61live",JSON.stringify(e)),X(e)})).catch((function(e){console.error("دیتا دریافت نشد",e),ee(i.next_check)}))}),e)}function te(){if(w){var e,t,i=1*new Date,n=0,s=!1;function r(){Object.keys(T).forEach((function(e){e.startsWith(D)&&T.removeItem(e)})),location.reload()}function o(e){e?t=setInterval((function(){l(),a()}),5e3):t&&(clearInterval(t),a())}function a(){var e=parseInt(n/1e3);if(e>3){var t=T.getItem(D+x);if(t){var i=0;(t=JSON.parse(t)).time["d"+p]&&"number"!=typeof(i=t.time["d"+p])&&(i=0),t.time["d"+p]=i+e}else(t={url:S,img:m.src,title:g,time:{}}).time["d"+p]=e;t=JSON.stringify(t),T.setItem(D+x,t)}}function l(){e=1*new Date,n=e-i,i=e}!function(){try{if(JSON.stringify(T).length/1024/1204>4.2)for(var e,t,i=Object.keys(T),n=p-30,s=0;s<i.length;s++)if(i[s].startsWith(D)){e=JSON.parse(T.getItem(i[s])),t=Object.keys(e.time);for(var o=1;o<n;o++)delete t.time["d"+o];T.setItem(i[s],t)}JSON.stringify(T).length/1024/1204>3.5&&r()}catch(e){console.error(e),r()}}(),document.addEventListener("visibilitychange",(function(){s?"hidden"===document.visibilityState?(l(),o(!1)):"visible"===document.visibilityState&&(i=1*new Date,o(!0)):(l(),s=!0,o(!1))})),o(!0)}}function ie(e){var t=0,i=(e=e.toLowerCase()).length,n=0;if(i>0)for(;n<i;)t=(t<<5)-t+e.charCodeAt(n++)|0;return t}function ne(){document.querySelectorAll("a").forEach((function(e){e.setAttribute("target","_self")}))}if(k===_){var se=!0;try{window.top.location.origin}catch(e){se=!(e=e.toString().toLowerCase()).includes("cross")&&!e.includes("blocked")}var re=se&&null===window.frameElement&&window.top.location.origin===window.self.location.origin,oe=se&&null!==window.frameElement&&window.top.location.origin===window.self.location.origin,ae=!se||null===window.frameElement&&window.top.location.origin!==window.self.location.origin;re?(console.log("+++++++++++++++++++++++++ isSameOrigin and Not isInIFrame (Normal Statistics show) ++++++++++++++++++++++"),te(),function(){function e(t){setTimeout((function(){var t,n,s=JSON.parse(T.getItem("s61program")),r=1*new Date;s&&(t=s.last_check,n=s.next_check),s&&t+n>r?(e(s.next_check),i(s)):fetch(I).then((function(e){return e.json()})).then((function(t){t.last_check=r,e(t.next_check),T.setItem("s61program",JSON.stringify(t)),i(t)})).catch((function(e){console.error("دیتا دریافت نشد",e)}))}),t)}function i(e){if(console.log("++++++++++++++++++++++++ s61ProgramProcess ++++++++++++++ obj:",e),e&&Object.keys(e).length>0){if(f.style.removeProperty("display"),U(W,1),w){var i=Y("#s61e");K(c,"s61u",1),T.getItem(L+x)||(U(i,1),i.onclick=function(){var e={hash:x,path:S,title:g,img:m.src,time:1*new Date};T.setItem(L+x,JSON.stringify(e)),U(i,0)})}A=[],P={},function(){let e=B();for(let i=0;i<7;i++){let n=new Date(e+864e5*i);console.log("javad BUG : day:",n,"WEEKLY_SCHEDULE:",t,"day.getDay():",n.getDay(),"getKeyByValue(WEEKLY_SCHEDULE, dayOfWeek, day.getDay()):",ye(t,"dayOfWeek",n.getDay())),ye(t,"dayOfWeek",n.getDay()).baseDate=n.getTime()}}();let n=e.sitestrid,r=e.siteid,o=e.list;if(N=e,e.list)for(let e=0;e<o.length;e++)le(o[e],o[e].program.interval,n,r),pe(o[e],o[e].program.specefic,n,r),de(o[e],n,r);!function(e){if(e){let t=e.program,i={};for(const e of t)i.startEventTime=1e3*e.time[0],i.endEventTime=1e3*e.time[1],i.eventType=s,i.siteLogo=O+`site/${e.sitestrid}/site_logo.jpg`,i.sitestrid=e.sitestrid,i.siteid=e.siteid,i.supporterImage=O+`user/${e.supporterusername}/user_avatar.jpg`,i.supportername=e.supportername,i.supporterid=e.supporterid,i.title=e.title,i.eventRangeTime=ce(1e3*e.time[0],1e3*e.time[1]),A.push(i),i={}}}(e.adslist),ke.innerHTML="";for(let e=0;e<28;e++){let t=ge(e),i=`d${e+1}`;P[i]={startDate:t.thisDay,endDate:t.nextDay,dayOfWeek:t.dayOfWeek,day:t.day,events:me(t.thisDay,t.nextDay,"d1"==i)};let n=P[i].events.filter((e=>{if(-1!=e.startEventTime)return e})).length;ve(t.dayOfWeek,n,t.day,i),0==e&&Y(".s61_button_part_one").click()}he(u||P.d1),V()}}e(9)}()):oe?(console.log("+++++++++++++++++++++++++ isSameOrigin and isInIframe (live iframe) ++++++++++++++++++++++"),z(),ne(),function(){function e(e){window.top.postMessage(e,_)}window.addEventListener("message",(function(t){t.origin===_&&("url"===(t=t.data).c?e({c:"url",isvalid:w,host:location.origin,path:S,title:g,img:m.src,hash:x}):"ga"===t.c&&y&&ga("create",y,"auto",{clientId:t.gacid}))})),e(w?{c:"url",isvalid:w,host:location.origin,path:S,title:g,img:m.src,hash:x}:v?{c:"url",isvalid:!0,host:location.origin,path:S,title:v.textContent}:{c:"url",isvalid:w})}()):ae&&(console.log("+++++++++++++++++++++++++ NOT sameOrigin (profile iframe) ++++++++++++++++++++++"),z(),ne(),te())}else console.log("library is not related to site");function le(e,n,s,r){n&&Object.keys(n).forEach((o=>{for(const a of n[o]){let n=ue(new Date(t[o].baseDate),a.time),l=n.sTime,d=n.eTime;for(let t=0;t<4;t++){let n={};n.startEventTime=l+6048e5*t,n.endEventTime=d+6048e5*t,n.eventType=i,n.sitestrid=s,n.siteid=r,n.siteLogo=O+`site/${s}/site_logo.jpg`,n.supporterImage=O+`user/${e.supporterstrid}/user_avatar.jpg`,n.supportername=e.supportername,n.supporterid=e.supporterid,n.title=a.title,n.eventRangeTime=ce(l,d),A.push(n)}}}))}function de(e,t,i){let n={startEventTime:-1,endEventTime:-1};n.eventType=r,n.sitestrid=t,n.siteid=i,n.siteLogo=O+`site/${t}/site_logo.jpg`,n.supporterImage=O+`user/${e.supporterstrid}/user_avatar.jpg`,n.supportername=e.supportername,n.supporterid=e.supporterid,n.title="بزودی لایو برگزار می شود",n.eventRangeTime="الان وارد اتاق لایو شوید",A.push(n)}function ue(e,t){let i,n;return null==t[1][1]||0==t[1][0]?(i=e.setHours(t[0][0],t[0][1]),n=e.setHours(24,0)):(i=e.setHours(t[0][0],t[0][1]),n=e.setHours(t[1][0],t[1][1])),{sTime:i,eTime:n}}function pe(e,t,i,s){if(t){let r={};for(const o of t)r.startEventTime=1e3*o.time[0],r.endEventTime=1e3*o.time[1],r.eventType=n,r.sitestrid=i,r.siteid=s,r.siteLogo=O+`site/${i}/site_logo.jpg`,r.supporterImage=O+`user/${e.supporterstrid}/user_avatar.jpg`,r.supportername=e.supportername,r.supporterid=e.supporterid,r.title=o.title,r.eventRangeTime=ce(r.startEventTime,r.endEventTime),A.push(r),r={}}}function ce(e,t){return`از ${fe(e)} تا ${fe(t)}`}function fe(e){let t=new Date(e);return(2==String(t.getHours()).length?t.getHours():`0${t.getHours()}`)+":"+(2==String(t.getMinutes()).length?t.getMinutes():`0${t.getMinutes()}`)}function me(e,t,i){let n,s=Date.now();return n=i?A.filter((i=>-1==i.startEventTime&&-1==i.endEventTime||i.startEventTime>=e&&i.endEventTime<=t&&s<i.endEventTime)):A.filter((i=>i.startEventTime>=e&&i.endEventTime<=t&&s<i.endEventTime+0)),n.length>30&&(n=n.sort((()=>.5-Math.random()))),n.sort(((e,t)=>e.startEventTime-t.startEventTime||e.endEventTime-t.endEventTime))}function ge(e){let t=B(),i=t+864e5*e;return{thisDay:i,nextDay:t+864e5*(e+1),day:new Date(i).toLocaleDateString("fa-IR"),dayOfWeek:new Date(i).getDay()}}function ve(e,i,n,s){let r=document.createElement("button");r.classList.add("s61_button_on_table"),r.setAttribute("onclick","s61ntrx.s61ShowDayDisplay(this)"),r.setAttribute("day",s),r.innerHTML=`<div class="s61_button_part_one"><span>${ye(t,"dayOfWeek",e).name}</span><span class="s61_show_number_of_day">${i}</span></div><span class="s61_date_of_day">${n}</span>`,ke.appendChild(r)}function he(e){let t=e.events;Y(".s61_lives_table table > tbody").remove();let i=document.createElement("tbody");if(Y(".s61_lives_table table").appendChild(i),0===t.filter((e=>{if(e.startEventTime>99)return e})).length)_e(".s61_body_live_table_hidden",".s61_body_live_table_info"),o(Y(".s61_body_live_table_hidden>div"),!1,10);else{_e(".s61_body_live_table_info",".s61_body_live_table_hidden");for(let e=0;e<t.length;e++)if(-1!=t[e].startEventTime){let n=document.createElement("tr"),s="";t[e].isonline?(s+='<td><a href="'+O+"s/"+t[e].sitestrid+"?snum="+t[e].supporterid+'" target="_blank" class="program_live_bt">ورود<span class="s61_icon_animated_online"></span></a></td></tr>',n.classList.add("program_is_live")):s+='<td><a href="http://www.google.com/calendar/render?action=TEMPLATE&text='+t[e].title+"&dates="+be(t[e].startEventTime)+"Z/"+be(t[e].endEventTime)+"&details="+O+"s/"+t[e].sitestrid+"?snum="+t[e].supporterid+'" target="_blank" class="program_live_bt program_reserve_bt">یادآوری<span>&#10133;</span></a></td></tr>',s+=`<tr class="program_is_live"><td><img src="${t[e].siteLogo}" alt=""></td><td class="s61ltr"><a target="_blank" rel="nofollow noopener noreferrer" href="`+O+"s/"+t[e].sitestrid+'">'+t[e].sitestrid+"</a></td><td>"+`<img src="${t[e].supporterImage}" alt=""></td><td>`+`${t[e].supportername}</td><td>`+`${t[e].title}</td><td>`+`${t[e].eventRangeTime}</td>`,n.innerHTML=s,i.appendChild(n)}}}function _e(e,t){e&&U(Y(e),1),t&&U(Y(t))}function ye(e,t,i){let n=Object.keys(e).find((n=>e[n][t]===i));return e[n]}function be(e){let t=new Date(e),i=(t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()).split("/");return i=i[2]+""+(1==i[0].length?"0"+i[0]:i[0])+(1==i[1].length?"0"+i[1]:i[1]),`${i}T${Ee(t.getHours())+""+Ee(t.getMinutes())+Ee(t.getSeconds())}`}function Ee(e){return 1==String(e).length?"0"+e:e}s61ntrx.s61ShowDayDisplay=function(e){document.querySelectorAll(".s61_button_on_table").forEach((e=>{e.classList.remove("program_is_live")})),e.classList.add("program_is_live");let t=e.getAttribute("day");null!==t&&he(u=P[t])},document.addEventListener("click",(t=>{let i=t.target;do{if(i==e||i==c)return;i=i.parentNode}while(i);e.classList.contains(R)||Te()}));let we=0;function Te(){Object.keys(P).length>0&&(e.classList.toggle(R),we=parseFloat(getComputedStyle(ke).width))}Y(".s61_live_calendar_button").onclick=()=>{Te()},Y("#s61programbt").onclick=()=>{Te(),o(Y(".s61_body_live_table_hidden>div"),!1,10)};let De=Y("#s61_next_button"),Le=Y("#s61_prev_button"),ke=Y("#s61_paginated_list");ke.scrollLeft=0,De.addEventListener("click",(()=>{_e("#s61_prev_button > img"),-1*ke.scrollLeft+2.2*we>ke.scrollWidth&&_e("#s61_prev_button > img","#s61_next_button > img"),ke.scrollLeft-=we})),Le.addEventListener("click",(()=>{_e("#s61_next_button > img"),-1*ke.scrollLeft<1.2*we&&_e("#s61_next_button > img","#s61_prev_button > img"),ke.scrollLeft+=we})),_e("#s61_next_button > img","#s61_prev_button > img"),function(e){let t,i,n,s,r=!1,o=function(){r=!1};e.addEventListener("mousemove",(o=>{if(o.preventDefault(),!r)return;const a=o.pageX-e.offsetLeft,l=o.pageY-e.offsetTop,d=a-t,u=l-n;e.scrollLeft=i-d,e.scrollTop=s-u})),e.addEventListener("mousedown",(function(o){r=!0,t=o.pageX-e.offsetLeft,n=o.pageY-e.offsetTop,i=e.scrollLeft,s=e.scrollTop}),!1),e.addEventListener("mouseup",o,!1),e.addEventListener("mouseleave",o,!1)}(Y(".s61_lives_table"))}));