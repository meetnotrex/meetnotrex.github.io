var s61ntrx={};document.addEventListener("DOMContentLoaded",(function(){const e=J(".s61_calendar"),t={d1:{name:"شنبه",dayOfWeek:6,baseDate:""},d2:{name:"یکشنبه",dayOfWeek:0,baseDate:""},d3:{name:"دوشنبه",dayOfWeek:1,baseDate:""},d4:{name:"سه شنبه",dayOfWeek:2,baseDate:""},d5:{name:"چهارشنبه",dayOfWeek:3,baseDate:""},d6:{name:"پنجشنبه",dayOfWeek:4,baseDate:""},d7:{name:"جمعه",dayOfWeek:5,baseDate:""}},i={interval:1,specefic:2,trafficAds:3,withoutProgram:4};let n=(e,t=!1,i=0,n=5,o=15)=>{setTimeout((()=>{let a=e.clientWidth-i,l=0,d=document.createElement("p");d.style.position="fixed",d.style.fontFamily=r(e,"font-family"),d.style.fontWeight=r(e,"font-weight");let u=r(e,"white-space");if(t){e.style.whiteSpace="nowrap",e.appendChild(d);let t=0;for(const i of e.childNodes)if(i.id){let e=i.currentStyle||window.getComputedStyle(i),n=parseFloat(e.marginLeft)+parseFloat(e.marginRight),s=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight),r=parseFloat(e.borderLeftWidth)+parseFloat(e.borderRightWidth);l+=parseInt(i.offsetWidth),t+=n+s+r}let i=parseInt(getComputedStyle(e).fontSize);d.remove(),s(e,i,a,l,t,n,o),e.style.whiteSpace=u}else{d.textContent=e.textContent,d.style.whiteSpace="nowrap",e.appendChild(d);let t=e.currentStyle||window.getComputedStyle(e),i=(parseFloat(t.marginLeft),parseFloat(t.marginRight),parseFloat(t.paddingLeft),parseFloat(t.paddingRight),parseFloat(t.borderLeftWidth),parseFloat(t.borderRightWidth),parseInt(getComputedStyle(e).fontSize));l=d.offsetWidth,d.remove(),s(e,i,a,l,0,n,o),e.style.whiteSpace=u}}),200)},s=(e,t,i,n,s=0,r,o)=>{let a=Math.floor(t*((i-s)/n)*10)/10;e.style=a>o?`font-size : ${o}px;`:a<r?`font-size : ${r}px;`:`font-size : ${a}px;`},r=(e,t)=>window.getComputedStyle(e,null).getPropertyValue(t);var o,a,l=Math.floor((1*new Date-1*new Date(2023,8,23))/864e5),d=J("#s61w"),u=J("#s61_parent"),p=J(d.dataset.i),c=J(d.dataset.t),f=J("h1"),m=J("#s61i"),g=d.dataset.baseurl,v=d.dataset.ga,h=d.dataset.domain,_=J("#s61profile"),y=(c=null!==c?c.textContent.trim():null,l>1&&null!==p&&null!==c&&void 0!==h),b=localStorage,w="/kharidlive/v1/lib_assistant/",E="S61P",T="S61F",D=window.self.location.origin,k=decodeURIComponent(location.pathname),L="https://kharidlive.ir/",S=ee(k),x=L+"liveouter/v2/programlist?hash="+ee(h),O=L+"liveouter/v2/livestatus?hash="+ee(h)+"&adssiteandsupporterid=",I=J("#s61m"),C=J("#s61a"),$=J("#s61n"),W=(J("#s61s"),1),j=[],F={},M=J(".s61_info_state"),N="s61o",R=J("#s61timestartlive"),H=J("#s61supportername"),A=[],q={};function J(e){return document.querySelector(e)}function P(){u.style.display="none"}function z(e,t){Y(e,N,t)}function Y(e,t,i){e&&e.classList&&(e=e.classList,i?e.remove(t):e.add(t))}function X(e){let t=e?new Date(e):new Date;return t=t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear(),t=new Date(t).getTime(),t}function U(){var e=document.createElement("link");e.type="text/css",e.rel="stylesheet",e.href=w+"lib_assistant.css",document.head.appendChild(e),K(9)}function V(e){if(function(e){let t=1*new Date;if(e){let i=q.d1.events;if(i.forEach((e=>{e.isonline=0})),e.selflive&&e.selflive.length>0)for(let n=0;n<e.selflive.length;n++){i.find((i=>{if(i.startEventTime<=t&&t<=i.endEventTime&&i.supporterid==e.selflive[n].supporterid)return!0}))?i.forEach((i=>{i.startEventTime<=t&&t<=i.endEventTime&&i.supporterid==e.selflive[n].supporterid&&(i.isonline=e.selflive[n].isonline,i.liveTitle=e.selflive[n].title,i.viewerqty=e.selflive[n].viewerqty)})):i.forEach((t=>{if((-1==t.startEventTime||0==t.startEventTime)&&t.supporterid==e.selflive[n].supporterid){let i=e.selflive[n].isonline;t.startEventTime=i?0:-1,t.isonline=i,t.liveTitle=e.selflive[n].title,t.viewerqty=e.selflive[n].viewerqty}}))}if(e.adslive&&e.adslive.length>0)for(let n=0;n<e.adslive.length;n++)i.forEach((i=>{i.startEventTime<=t&&t<=i.endEventTime&&i.siteid==e.adslive[n].siteid&&i.supporterid==e.adslive[n].supporterid&&(i.isonline=e.adslive[n].isonline,i.viewerqty=e.adslive[n].viewerqty)}))}let i=q.d1;i.events=ce(i.startDate,i.endDate,!0);let n=0;for(let e=0;e<i.events.length;e++)i.events[e].endEventTime>t&&n++;J("#s61_paginated_list button:nth-child(1) .s61_show_number_of_day").textContent=n,ge(a)}(e),j=[],e.selflive&&e.selflive.length>0&&e.selflive.forEach((e=>{F.list.find((t=>{e.isonline&&t.supporterid==e.supporterid&&(e.supportername=t.supportername,e.supporterstrid=t.supporterstrid,e.siteid=F.siteid,e.sitestrid=F.sitestrid,Z(j,[["sitestrid",e.sitestrid],["supporterid",e.supporterid]])&&j.push(e))}))})),e.adslive&&e.adslive.length>0&&e.adslive.forEach((e=>{F.adslist.program.find((t=>{e.isonline&&t.supporterid==e.supporterid&&t.siteid==e.siteid&&(e.supportername=t.supportername,e.supporterstrid=t.supporterusername,e.siteid=t.siteid,e.sitestrid=t.sitestrid,e.title=t.title,Z(j,[["sitestrid",e.sitestrid],["supporterid",e.supporterid]])&&j.push(e))}))})),(!e.adslive||e.adslive.length<1)&&(!e.selflive||e.selflive.length<1)){let e=0,t=Object.keys(q);for(let i=0;i<t.length;i++){let n=q[t[i]];if(n.events&&n.events.length>0&&(n.events.forEach((t=>{t.startEventTime>99&&(Z(j,[["sitestrid",t.sitestrid],["supporterid",t.supporterid]])&&j.push(t),e++)})),e>0))break}if(e<1){let e=q.d1;e&&(e=e.events,e&&e.forEach((e=>{Z(j,[["sitestrid",e.sitestrid],["supporterid",e.supporterid]])&&j.push(e)})))}}if(j.length<1)z(C),$.textContent=e.msg?e.msg:-2===e.status?"لایو ناترکس غیر فعال است":"برنامه ای قرار نگرفته است",R.textContent="",n($);else{var t=0;I.onmouseenter=I.onmouseleave=function(e){W="mouseleave"===e.type?1:0},B(j[t]),j.length>1&&(clearInterval(o),o=setInterval((function(){W&&(t>=j.length-1&&(t=-1),B(j[++t]))}),1e4))}}function Z(e,t){let i=0;return 0==e.length||(t.forEach((t=>{2==t.length&&e.forEach((e=>{e[t[0]]==t[1]&&i++}))})),!(i==t.length))}function B(e){G(),setTimeout((function(){_.href=L+"s/"+e.sitestrid+"?snum="+e.supporterid,G(),R.classList.remove("s61livemode"),e.isonline?(Y(m,"s61anim"),R.textContent=e.viewerqty+" بیننده",R.classList.add("s61livemode"),Y(d,"s61_blink")):(Y(d,"s61_blink",1),R.textContent=e.startEventTime>999?function(e){let i=new Date(e),n=he(t,"dayOfWeek",i.getDay()).name,s=1==String(i.getMinutes()).length?"0"+i.getMinutes():i.getMinutes(),r=i.getHours()+":"+s;return n+" "+r}(e.startEventTime):"",Y(m,"s61anim",1)),$.textContent=e.title,C.src=e.supporterImage?e.supporterImage:L+"user/"+e.supporterstrid+"/user_avatar.jpg",H.textContent=e.supportername,n($),n(M,!0,40)}),800)}function G(){I.classList.toggle("s61h")}function K(e){setTimeout((function(){var e,t,n=JSON.parse(b.getItem("s61live")),s=1*new Date;n&&(e=n.last_check,t=n.next_check),n&&e+t>s?(K(n.next_check),V(n)):fetch(O+function(){let e="",t=1*new Date,n=A.filter((e=>{if(e.startEventTime<=t&&t<=e.endEventTime)return e}));for(const t of n)t.eventType==i.trafficAds&&(e+=`${t.siteid}:${t.supporterid},`);return e.length>1?e:"no"}()).then((function(e){return e.json()})).then((function(e){e.last_check=s,K(e.next_check),b.setItem("s61live",JSON.stringify(e)),V(e)})).catch((function(e){console.error("دیتا دریافت نشد",e),K(n.next_check)}))}),e)}function Q(){if(y){var e,t,i=1*new Date,n=0,s=!1;function r(){Object.keys(b).forEach((function(e){e.startsWith(E)&&b.removeItem(e)})),location.reload()}function o(e){e?t=setInterval((function(){d(),a()}),5e3):t&&(clearInterval(t),a())}function a(){var e=parseInt(n/1e3);if(e>3){var t=b.getItem(E+S);if(t){var i=0;(t=JSON.parse(t)).time["d"+l]&&"number"!=typeof(i=t.time["d"+l])&&(i=0),t.time["d"+l]=i+e}else(t={url:k,img:p.src,title:c,time:{}}).time["d"+l]=e;t=JSON.stringify(t),b.setItem(E+S,t)}}function d(){e=1*new Date,n=e-i,i=e}!function(){try{if(JSON.stringify(b).length/1024/1204>4.2)for(var e,t,i=Object.keys(b),n=l-30,s=0;s<i.length;s++)if(i[s].startsWith(E)){e=JSON.parse(b.getItem(i[s])),t=Object.keys(e.time);for(var o=1;o<n;o++)delete t.time["d"+o];b.setItem(i[s],t)}JSON.stringify(b).length/1024/1204>3.5&&r()}catch(e){console.error(e),r()}}(),document.addEventListener("visibilitychange",(function(){s?"hidden"===document.visibilityState?(d(),o(!1)):"visible"===document.visibilityState&&(i=1*new Date,o(!0)):(d(),s=!0,o(!1))})),o(!0)}}function ee(e){var t=0,i=(e=e.toLowerCase()).length,n=0;if(i>0)for(;n<i;)t=(t<<5)-t+e.charCodeAt(n++)|0;return t}function te(){document.querySelectorAll("a").forEach((function(e){e.setAttribute("target","_self")}))}if(D===g){var ie=!0;try{window.top.location.origin}catch(e){ie=!(e=e.toString().toLowerCase()).includes("cross")&&!e.includes("blocked")}var ne=ie&&null===window.frameElement&&window.top.location.origin===window.self.location.origin,se=ie&&null!==window.frameElement&&window.top.location.origin===window.self.location.origin,re=!ie||null===window.frameElement&&window.top.location.origin!==window.self.location.origin;ne?(console.log("+++++++++++++++++++++++++ isSameOrigin and Not isInIFrame (Normal Statistics show) ++++++++++++++++++++++"),Q(),function(){function e(t){setTimeout((function(){var t,i,s=JSON.parse(b.getItem("s61program")),r=1*new Date;s&&(t=s.last_check,i=s.next_check),s&&t+i>r?(e(s.next_check),n(s)):fetch(x).then((function(e){return e.json()})).then((function(t){t.last_check=r,e(t.next_check),b.setItem("s61program",JSON.stringify(t)),n(t)})).catch((function(e){console.error("دیتا دریافت نشد",e)}))}),t)}function n(e){if(console.log("++++++++++++++++++++++++ s61ProgramProcess ++++++++++++++ obj:",e),e&&Object.keys(e).length>0){if(u.style.removeProperty("display"),z(I,1),y){var n=J("#s61e");Y(d,"s61u",1),b.getItem(T+S)||(z(n,1),n.onclick=function(){var e={hash:S,path:k,title:c,img:p.src,time:1*new Date};b.setItem(T+S,JSON.stringify(e)),z(n,0)})}A=[],q={},function(){let e=X();for(let i=0;i<7;i++){let n=new Date(e+864e5*i);he(t,"dayOfWeek",n.getDay()).baseDate=n.getTime()}}();let s=e.sitestrid,r=e.siteid,o=e.list;if(F=e,e.list)for(let e=0;e<o.length;e++)oe(o[e],o[e].program.interval,s,r),de(o[e],o[e].program.specefic,s,r),ae(o[e],s,r);!function(e){if(e){let t=e.program,n={};for(const e of t)n.startEventTime=1e3*e.time[0],n.endEventTime=1e3*e.time[1],n.eventType=i.trafficAds,n.siteLogo=L+`site/${e.sitestrid}/site_logo.jpg`,n.sitestrid=e.sitestrid,n.siteid=e.siteid,n.supporterImage=L+`user/${e.supporterusername}/user_avatar.jpg`,n.supportername=e.supportername,n.supporterid=e.supporterid,n.title=e.title,n.eventRangeTime=ue(1e3*e.time[0],1e3*e.time[1]),A.push(n),n={}}}(e.adslist),De.innerHTML="";for(let e=0;e<28;e++){let t=fe(e),i=`d${e+1}`;q[i]={startDate:t.thisDay,endDate:t.nextDay,dayOfWeek:t.dayOfWeek,day:t.day,events:ce(t.thisDay,t.nextDay,"d1"==i)};let n=q[i].events.filter((e=>{if(-1!=e.startEventTime)return e})).length;me(t.dayOfWeek,n,t.day,i),0==e&&J(".s61_button_part_one").click()}ge(a||q.d1),U()}}e(9)}()):se?(console.log("+++++++++++++++++++++++++ isSameOrigin and isInIframe (live iframe) ++++++++++++++++++++++"),P(),te(),function(){function e(e){window.top.postMessage(e,g)}window.addEventListener("message",(function(t){t.origin===g&&("url"===(t=t.data).c?e({c:"url",isvalid:y,host:location.origin,path:k,title:c,img:p.src,hash:S}):"ga"===t.c&&v&&ga("create",v,"auto",{clientId:t.gacid}))})),e(y?{c:"url",isvalid:y,host:location.origin,path:k,title:c,img:p.src,hash:S}:f?{c:"url",isvalid:!0,host:location.origin,path:k,title:f.textContent}:{c:"url",isvalid:y})}()):re&&(console.log("+++++++++++++++++++++++++ NOT sameOrigin (profile iframe) ++++++++++++++++++++++"),P(),te(),Q())}else console.log("library is not related to site");function oe(e,n,s,r){n&&Object.keys(n).forEach((o=>{for(const a of n[o]){let n=le(new Date(t[o].baseDate),a.time),l=n.sTime,d=n.eTime;for(let t=0;t<4;t++){let n={};n.startEventTime=l+6048e5*t,n.endEventTime=d+6048e5*t,n.eventType=i.interval,n.sitestrid=s,n.siteid=r,n.siteLogo=L+`site/${s}/site_logo.jpg`,n.supporterImage=L+`user/${e.supporterstrid}/user_avatar.jpg`,n.supportername=e.supportername,n.supporterid=e.supporterid,n.title=a.title,n.eventRangeTime=ue(l,d),A.push(n)}}}))}function ae(e,t,n){let s={startEventTime:-1,endEventTime:-1};s.eventType=i.withoutProgram,s.sitestrid=t,s.siteid=n,s.siteLogo=L+`site/${t}/site_logo.jpg`,s.supporterImage=L+`user/${e.supporterstrid}/user_avatar.jpg`,s.supportername=e.supportername,s.supporterid=e.supporterid,s.title="بزودی لایو برگزار می شود",s.eventRangeTime="الان وارد اتاق لایو شوید",A.push(s)}function le(e,t){let i,n;return null==t[1][1]||0==t[1][0]?(i=e.setHours(t[0][0],t[0][1]),n=e.setHours(24,0)):(i=e.setHours(t[0][0],t[0][1]),n=e.setHours(t[1][0],t[1][1])),{sTime:i,eTime:n}}function de(e,t,n,s){if(t){let r={};for(const o of t)r.startEventTime=1e3*o.time[0],r.endEventTime=1e3*o.time[1],r.eventType=i.specefic,r.sitestrid=n,r.siteid=s,r.siteLogo=L+`site/${n}/site_logo.jpg`,r.supporterImage=L+`user/${e.supporterstrid}/user_avatar.jpg`,r.supportername=e.supportername,r.supporterid=e.supporterid,r.title=o.title,r.eventRangeTime=ue(r.startEventTime,r.endEventTime),A.push(r),r={}}}function ue(e,t){return`از ${pe(e)} تا ${pe(t)}`}function pe(e){let t=new Date(e);return(2==String(t.getHours()).length?t.getHours():`0${t.getHours()}`)+":"+(2==String(t.getMinutes()).length?t.getMinutes():`0${t.getMinutes()}`)}function ce(e,t,i){let n,s=Date.now();return n=i?A.filter((i=>-1==i.startEventTime&&-1==i.endEventTime||i.startEventTime>=e&&i.endEventTime<=t&&s<i.endEventTime)):A.filter((i=>i.startEventTime>=e&&i.endEventTime<=t&&s<i.endEventTime+0)),n.length>30&&(n=n.sort((()=>.5-Math.random()))),n.sort(((e,t)=>e.startEventTime-t.startEventTime||e.endEventTime-t.endEventTime))}function fe(e){let t=X(),i=t+864e5*e;return{thisDay:i,nextDay:t+864e5*(e+1),day:new Date(i).toLocaleDateString("fa-IR"),dayOfWeek:new Date(i).getDay()}}function me(e,i,n,s){let r=document.createElement("button");r.classList.add("s61_button_on_table"),r.setAttribute("onclick","s61ntrx.s61ShowDayDisplay(this)"),r.setAttribute("day",s),r.innerHTML=`<div class="s61_button_part_one"><span>${he(t,"dayOfWeek",e).name}</span><span class="s61_show_number_of_day">${i}</span></div><span class="s61_date_of_day">${n}</span>`,De.appendChild(r)}function ge(e){let t=e.events;J(".s61_lives_table table > tbody").remove();let i=document.createElement("tbody");if(J(".s61_lives_table table").appendChild(i),0===t.filter((e=>{if(e.startEventTime>99)return e})).length)ve(".s61_body_live_table_hidden",".s61_body_live_table_info"),n(J(".s61_body_live_table_hidden>div"),!1,10);else{ve(".s61_body_live_table_info",".s61_body_live_table_hidden");for(let e=0;e<t.length;e++)if(-1!=t[e].startEventTime){let n=document.createElement("tr"),s="";t[e].isonline?(s+='<td><a href="'+L+"s/"+t[e].sitestrid+"?snum="+t[e].supporterid+'" target="_blank" class="program_live_bt">ورود<span class="s61_icon_animated_online"></span></a></td></tr>',n.classList.add("program_is_live")):s+='<td><a href="http://www.google.com/calendar/render?action=TEMPLATE&text='+t[e].title+"&dates="+_e(t[e].startEventTime)+"Z/"+_e(t[e].endEventTime)+"&details="+L+"s/"+t[e].sitestrid+"?snum="+t[e].supporterid+'" target="_blank" class="program_live_bt program_reserve_bt">یادآوری<span>&#10133;</span></a></td></tr>',s+=`<tr class="program_is_live"><td><img src="${t[e].siteLogo}" alt=""></td><td class="s61ltr"><a target="_blank" rel="nofollow noopener noreferrer" href="`+L+"s/"+t[e].sitestrid+'">'+t[e].sitestrid+"</a></td><td>"+`<img src="${t[e].supporterImage}" alt=""></td><td>`+`${t[e].supportername}</td><td>`+`${t[e].title}</td><td>`+`${t[e].eventRangeTime}</td>`,n.innerHTML=s,i.appendChild(n)}}}function ve(e,t){e&&z(J(e),1),t&&z(J(t))}function he(e,t,i){let n=Object.keys(e).find((n=>e[n][t]===i));return e[n]}function _e(e){let t=new Date(e),i=(t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear()).split("/");return i=i[2]+""+(1==i[0].length?"0"+i[0]:i[0])+(1==i[1].length?"0"+i[1]:i[1]),`${i}T${ye(t.getHours())+""+ye(t.getMinutes())+ye(t.getSeconds())}`}function ye(e){return 1==String(e).length?"0"+e:e}s61ntrx.s61ShowDayDisplay=function(e){document.querySelectorAll(".s61_button_on_table").forEach((e=>{e.classList.remove("program_is_live")})),e.classList.add("program_is_live");let t=e.getAttribute("day");null!==t&&ge(a=q[t])},document.addEventListener("click",(t=>{let i=t.target;do{if(i==e||i==d)return;i=i.parentNode}while(i);e.classList.contains(N)||we()}));let be=0;function we(){Object.keys(q).length>0&&(e.classList.toggle(N),be=parseFloat(getComputedStyle(De).width))}J(".s61_live_calendar_button").onclick=()=>{we()},J("#s61programbt").onclick=()=>{we(),n(J(".s61_body_live_table_hidden>div"),!1,10)};let Ee=J("#s61_next_button"),Te=J("#s61_prev_button"),De=J("#s61_paginated_list");De.scrollLeft=0,Ee.addEventListener("click",(()=>{ve("#s61_prev_button > img"),-1*De.scrollLeft+2.2*be>De.scrollWidth&&ve("#s61_prev_button > img","#s61_next_button > img"),De.scrollLeft-=be})),Te.addEventListener("click",(()=>{ve("#s61_next_button > img"),-1*De.scrollLeft<1.2*be&&ve("#s61_next_button > img","#s61_prev_button > img"),De.scrollLeft+=be})),ve("#s61_next_button > img","#s61_prev_button > img"),function(e){let t,i,n,s,r=!1,o=function(){r=!1};e.addEventListener("mousemove",(o=>{if(o.preventDefault(),!r)return;const a=o.pageX-e.offsetLeft,l=o.pageY-e.offsetTop,d=a-t,u=l-n;e.scrollLeft=i-d,e.scrollTop=s-u})),e.addEventListener("mousedown",(function(o){r=!0,t=o.pageX-e.offsetLeft,n=o.pageY-e.offsetTop,i=e.scrollLeft,s=e.scrollTop}),!1),e.addEventListener("mouseup",o,!1),e.addEventListener("mouseleave",o,!1)}(J(".s61_lives_table"))}));